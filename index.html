<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solo Leveling Study Grind</title>
  <link rel="icon" href="https://upload.wikimedia.org/wikipedia/en/2/23/Solo_Leveling_logo.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: url('https://wallpapercave.com/wp/wp9420280.jpg') no-repeat center center fixed;
      background-size: cover;
      position: relative;
    }
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: -1;
    }
    .flash { animation: flashEffect 1s ease-in-out; }
    @keyframes flashEffect {
      0% { background-color: rgba(255,255,255,0.4); }
      100% { background-color: transparent; }
    }
  </style>
</head>
<body class="text-white">
<div class="overlay"></div>
<div id="root"></div>
<script>
const { useState, useEffect } = React;

// ===== DATA =====
const normalPunishments = [
  "Do 20 push-ups", "Solve 50 GK questions",
  "Revise 2 topics", "No social media 6 hrs", "Read 30 pages"
];
const deathModePunishments = [
  "Study 6 hrs straight + summary", "200 questions + 50 push-ups",
  "Write all formulas twice", "Full mock test now + No phone 8 hrs", "Revise 5 topics + Cold shower"
];
const rewards = [
  "Watch 1 anime episode", "Eat favorite snack", "Listen to music",
  "Take a relaxing bath", "Play a game for 20 mins"
];
const rankTitles = ['E-Rank Hunter','D-Rank','C-Rank','B-Rank','A-Rank','S-Rank'];
const characterImages = [
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/male/45.png',
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/male/20.png',
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/female/68.png',
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/female/21.png'
];

// XP + Level Functions
function getXPForLevel(level){ return level*level*100; }
function getRank(level){
  if(level<5)return rankTitles[0];
  if(level<10)return rankTitles[1];
  if(level<15)return rankTitles[2];
  if(level<20)return rankTitles[3];
  if(level<25)return rankTitles[4];
  return rankTitles[5];
}

function App(){
  // ===== STATES =====
  const [xp,setXP]=useState(parseInt(localStorage.getItem('xp'))||0);
  const [level,setLevel]=useState(parseInt(localStorage.getItem('level'))||1);
  const [tasks,setTasks]=useState(JSON.parse(localStorage.getItem('tasks'))||[]);
  const [habits,setHabits]=useState(JSON.parse(localStorage.getItem('habits'))||[]);
  const [punishments,setPunishments]=useState(JSON.parse(localStorage.getItem('punishments'))||[]);
  const [showAddModal,setShowAddModal]=useState(false);
  const [newTask,setNewTask]=useState({type:'daily',title:'',start:'',end:'',days:''});
  const [bossCountdown,setBossCountdown]=useState(parseInt(localStorage.getItem('bossCountdown'))||0);
  const [rivalXP,setRivalXP]=useState(parseInt(localStorage.getItem('rivalXP'))||0);
  const [rivalLevel,setRivalLevel]=useState(parseInt(localStorage.getItem('rivalLevel'))||1);
  const [rivalStreak,setRivalStreak]=useState(parseInt(localStorage.getItem('rivalStreak'))||0);
  const [showLevelUp,setShowLevelUp]=useState(false);
  const [lockdownUntil,setLockdownUntil]=useState(parseInt(localStorage.getItem('lockdownUntil'))||0);
  const [error,setError]=useState('');

  // ===== LOCAL STORAGE SYNC =====
  useEffect(()=>{
    localStorage.setItem('xp',xp);
    localStorage.setItem('level',level);
    localStorage.setItem('tasks',JSON.stringify(tasks));
    localStorage.setItem('habits',JSON.stringify(habits));
    localStorage.setItem('punishments',JSON.stringify(punishments));
    localStorage.setItem('bossCountdown',bossCountdown);
    localStorage.setItem('rivalXP',rivalXP);
    localStorage.setItem('rivalLevel',rivalLevel);
    localStorage.setItem('rivalStreak',rivalStreak);
    localStorage.setItem('lockdownUntil',lockdownUntil);
  },[xp,level,tasks,habits,punishments,bossCountdown,rivalXP,rivalLevel,rivalStreak,lockdownUntil]);

  // ===== LEVEL UP =====
  useEffect(()=>{
    if(xp>=getXPForLevel(level)){
      setXP(xp-getXPForLevel(level));
      setLevel(level+1);
      setShowLevelUp(true);
      setTimeout(()=>setShowLevelUp(false),2000);
    }
  },[xp]);

  // Rival Level Update
  useEffect(()=>{
    if(rivalXP>=getXPForLevel(rivalLevel)){
      setRivalXP(rivalXP-getXPForLevel(rivalLevel));
      setRivalLevel(rivalLevel+1);
    }
  },[rivalXP]);

  // ===== DAILY RESET =====
  useEffect(()=>{
    const today=new Date().toDateString();
    const lastReset=localStorage.getItem('lastReset');
    if(lastReset!==today){
      const resetHabits=habits.map(h=>({...h,done:false}));
      setHabits(resetHabits);
      localStorage.setItem('lastReset',today);

      // Rival check for streak
      if(xp<rivalXP){
        setRivalStreak(rivalStreak+1);
        if(rivalStreak+1>=3){
          addPunishment({type:'mega',text:"Mega Punishment! You lagged 3 days behind rival!",deathMode:true});
          setRivalStreak(0);
        }
      }else{
        setRivalStreak(0);
      }
    }
  },[]);
// ===== HISTORY FOR BOSS SYSTEM =====
  function saveToHistory(title){
    const history=JSON.parse(localStorage.getItem('completedHistory'))||[];
    history.push({title,date:new Date().toISOString()});
    localStorage.setItem('completedHistory',JSON.stringify(history));
  }
  function getTopics(daysBack=7,limit=10){
    const history=JSON.parse(localStorage.getItem('completedHistory'))||[];
    const now=new Date();
    const cutoff=new Date();
    cutoff.setDate(now.getDate()-daysBack);
    const filtered=history.filter(item=>new Date(item.date)>=cutoff).map(item=>item.title);
    return filtered.slice(-limit);
  }

  // ===== BOSS SYSTEM =====
  useEffect(()=>{
    if(bossCountdown>=7){
      const topics=getTopics(30,7);
      const message=topics.length>0?`Boss Fight: Revise these topics:\n- ${topics.join('\n- ')}`:"Boss Fight: No recent topics!";
      addPunishment({type:'boss',text:message,deathMode:false});
      setBossCountdown(0);
    }
  },[bossCountdown]);

  useEffect(()=>{
    const today=new Date();
    const day=today.getDay();
    const lastWeekly=localStorage.getItem('lastWeeklyBoss');
    if(day===1 && lastWeekly!==today.toDateString()){
      const topics=getTopics(7,12);
      const message=topics.length>0?`Weekly Boss: Revise:\n- ${topics.join('\n- ')}`:"Weekly Boss: Nothing to revise this week!";
      addPunishment({type:'weeklyBoss',text:message,deathMode:true});
      localStorage.setItem('lastWeeklyBoss',today.toDateString());
    }
  },[]);

  // ===== RIVAL XP SIMULATION =====
  useEffect(()=>{
    const interval=setInterval(()=>{
      setRivalXP(prev=>prev+Math.floor(Math.random()*2));
    },3600000);
    return()=>clearInterval(interval);
  },[]);
  useEffect(()=>{
    const today=new Date().toDateString();
    const lastUpdate=localStorage.getItem('lastRivalUpdate');
    if(lastUpdate!==today){
      const gain=20+Math.floor(Math.random()*6);
      setRivalXP(prev=>prev+gain);
      localStorage.setItem('lastRivalUpdate',today);
    }
  },[]);

  // ===== LOCKDOWN MODE =====
  function activateLockdown(hours){
    const until=Date.now()+hours*3600000;
    setLockdownUntil(until);
  }
  const isLocked=Date.now()<lockdownUntil;

  // ===== TASK LOGIC =====
  function addTask(){
    if(isLocked){setError("Lockdown Mode Active! Can't add task.");return;}
    if(!newTask.title)return;
    const id=Date.now();
    const task={...newTask,id,done:false,created:new Date().toISOString()};
    if(newTask.type==='habit'){setHabits([...habits,task]);}
    else{setTasks([...tasks,task]);}
    setShowAddModal(false);
    setNewTask({type:'daily',title:'',start:'',end:'',days:''});
  }
  function completeTask(id){
    if(isLocked){setError("Lockdown Mode Active! Can't complete task.");return;}
    const completedTask=tasks.find(t=>t.id===id);
    setTasks(tasks.filter(t=>t.id!==id));
    setXP(xp+2);
    setBossCountdown(bossCountdown+1);
    if(completedTask)saveToHistory(completedTask.title);
  }
  function completeHabit(id){
    if(isLocked){setError("Lockdown Mode Active! Can't complete habit.");return;}
    const updated=habits.map(h=>h.id===id?{...h,done:true}:h);
    setHabits(updated);
    setXP(xp+1);
    const habit=habits.find(h=>h.id===id);
    if(habit)saveToHistory(habit.title);
  }
  function deleteHabit(id){ setHabits(habits.filter(h=>h.id!==id)); }

  // ===== PUNISHMENTS =====
  function addPunishment(p){ setPunishments([...punishments,p]); }
  function completePunishment(){
    if(isLocked){setError("Lockdown Mode Active! Can't clear punishment.");return;}
    const[first,...rest]=punishments;
    if(first.deathMode){
      const reward=rewards[Math.floor(Math.random()*rewards.length)];
      alert(`Reward Unlocked: ${reward}`);
    }
    setPunishments(rest);
  }
  function forgiveAll(){
    setXP(Math.max(0,xp-50));
    setPunishments([]);
    alert("Forgiven! Lost 50 XP.");
  }

  // ===== UI =====
  const today=new Date();
  const showWeeklyAlert=today.getDay()===2 && punishments.some(p=>p.type==='weeklyBoss');

  return React.createElement('div',{className:"p-4 max-w-3xl mx-auto bg-black bg-opacity-70 rounded-lg mt-6 shadow-lg "+(showLevelUp?'flash':'')},
    React.createElement('header',{className:"text-center mb-4"},
      React.createElement('h1',{className:"text-3xl font-bold"},"Solo Leveling Grind"),
      React.createElement('p',{className:"mt-2"},`Level ${level} (${getRank(level)})`),
      React.createElement('div',{className:"w-full bg-gray-700 rounded h-4 mt-2 overflow-hidden"},
        React.createElement('div',{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-4 rounded",style:{width:`${(xp/getXPForLevel(level))*100}%`}})),
      React.createElement('p',{className:"text-sm mt-1"},`${xp} / ${getXPForLevel(level)} XP`),
      React.createElement('img',{src:characterImages[Math.min(level-1,characterImages.length-1)],alt:"Character",className:"mx-auto w-32 mt-4"}),
      React.createElement('p',{className:"mt-2"},"Rival: Level "+rivalLevel+" | XP: "+rivalXP)
    ),
    showWeeklyAlert && React.createElement('div',{className:"bg-red-600 text-center p-4 text-2xl font-bold mb-4 rounded"},"⚠ Weekly Boss is waiting!"),
    error && React.createElement('p',{className:"bg-red-500 p-2 text-center rounded mb-4"},error),
    React.createElement('div',{className:"flex justify-between mb-4"},
      React.createElement('button',{onClick:()=>activateLockdown(1),className:"bg-purple-600 px-4 py-2 rounded"},`Lockdown 1h`),
      React.createElement('button',{onClick:forgiveAll,className:"bg-yellow-500 px-4 py-2 rounded"},"Forgive (Lose 50 XP)")
    ),
    punishments.length>0&&React.createElement('div',{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50"},
      React.createElement('div',{className:"bg-gray-800 p-6 rounded text-center max-w-md"},
        React.createElement('h2',{className:"text-2xl font-bold mb-4"},"Punishment"),
        React.createElement('pre',{className:"mb-4 whitespace-pre-wrap text-left"},punishments[0].text),
        React.createElement('button',{onClick:completePunishment,className:"bg-red-500 px-4 py-2 rounded text-white font-bold"},"Punishment Completed"),
        React.createElement('p',{className:"mt-2 text-sm"},`Remaining: ${punishments.length-1}`)
      )
    ),
    React.createElement('div',{className:"mt-6"},
      React.createElement('h2',{className:"text-xl mb-2 font-semibold"},"Daily & Timed Tasks"),
      React.createElement('div',{className:"mb-4 flex justify-end"},
        React.createElement('button',{onClick:()=>setShowAddModal(true),className:`px-4 py-2 rounded ${isLocked?"bg-gray-500":"bg-blue-500"}`,disabled:isLocked},"+ Add Task")
      ),
      tasks.length===0?
        React.createElement('p',{className:"text-center text-gray-300"},"No tasks yet."):
        tasks.map(task=>React.createElement('div',{key:task.id,className:"bg-gray-800 p-4 rounded mb-2 flex justify-between items-center"},
          React.createElement('div',null,
            React.createElement('p',{className:"font-bold"},task.title),
            React.createElement('p',{className:"text-sm text-gray-400"},task.type==='daily'?`Time: ${task.start}-${task.end}`:`Deadline: ${task.days} days`)
          ),
          React.createElement('button',{onClick:()=>completeTask(task.id),className:"bg-green-500 px-3 py-1 rounded"},"Done")
        ))
    ),
    React.createElement('div',{className:"mt-8"},
      React.createElement('h2',{className:"text-xl mb-2 font-semibold"},"Habit Tasks"),
      habits.length===0?
        React.createElement('p',{className:"text-center text-gray-300"},"No habits yet."):
        habits.map(h=>React.createElement('div',{key:h.id,className:"bg-gray-800 p-4 rounded mb-2 flex justify-between items-center"},
          React.createElement('p',{className:"font-bold"},h.title),
          React.createElement('div',null,
            React.createElement('button',{onClick:()=>completeHabit(h.id),disabled:h.done,className:`px-3 py-1 rounded ${h.done?"bg-gray-500":"bg-green-500"}`},h.done?"Done":"Mark Done"),
            React.createElement('button',{onClick:()=>deleteHabit(h.id),className:"bg-red-500 px-3 py-1 ml-2 rounded"},"Delete")
          )
        ))
    ),
    showAddModal&&React.createElement('div',{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"},
      React.createElement('div',{className:"bg-gray-900 p-6 rounded max-w-md w-full"},
        React.createElement('h2',{className:"text-xl mb-4 font-semibold"},"Add Task"),
        React.createElement('select',{value:newTask.type,onChange:e=>setNewTask({...newTask,type:e.target.value}),className:"mb-4 w-full p-2 text-black rounded"},
          React.createElement('option',{value:"daily"},"Daily Task"),
          React.createElement('option',{value:"timed"},"Timed Task"),
          React.createElement('option',{value:"habit"},"Habit Task")
        ),
        React.createElement('input',{type:"text",placeholder:"Task title",value:newTask.title,onChange:e=>setNewTask({...newTask,title:e.target.value}),className:"w-full mb-4 p-2 text-black rounded"}),
        newTask.type==='daily'?
          React.createElement(React.Fragment,null,
            React.createElement('input',{type:"time",className:"w-full mb-2 p-2 text-black rounded",onChange:e=>setNewTask({...newTask,start:e.target.value})}),
            React.createElement('input',{type:"time",className:"w-full mb-4 p-2 text-black rounded",onChange:e=>setNewTask({...newTask,end:e.target.value})})
          ):
          newTask.type==='timed'?
            React.createElement('input',{type:"number",placeholder:"Days",className:"w-full mb-4 p-2 text-black rounded",onChange:e=>setNewTask({...newTask,days:e.target.value})}):null,
        React.createElement('div',{className:"flex justify-end"},
          React.createElement('button',{onClick:addTask,className:"bg-blue-600 px-4 py-2 rounded"},"Add"),
          React.createElement('button',{onClick:()=>setShowAddModal(false),className:"ml-2 bg-gray-600 px-4 py-2 rounded"},"Cancel")
        )
      )
    )
  );
}
ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
</script>
</body>
</html>
  
