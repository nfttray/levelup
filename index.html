<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solo Leveling Grind</title>
  <link rel="icon" href="https://upload.wikimedia.org/wikipedia/en/2/23/Solo_Leveling_logo.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: url('https://wallpapercave.com/wp/wp9420280.jpg') no-repeat center center fixed;
      background-size: cover;
      position: relative;
    }
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: -1;
    }
    .flash { animation: flashEffect 1s ease-in-out; }
    @keyframes flashEffect {
      0% { background-color: rgba(255,255,255,0.4); }
      100% { background-color: transparent; }
    }
  </style>
</head>
<body class="text-white">
<div class="overlay"></div>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect } = React;

const normalPunishments = [
  "Do 20 push-ups", "Solve 50 GK questions", "Revise 2 topics",
  "No social media 6 hrs", "Read 30 pages"
];
const deathModePunishments = [
  "Study 6 hrs straight + summary", "200 questions + 50 push-ups",
  "Write all formulas twice", "Full mock test now + No phone 8 hrs", "Revise 5 topics + Cold shower"
];
const rewards = [
  "Watch 1 anime episode", "Eat favorite snack", "Listen to music", "Take a relaxing bath", "Play a game for 20 mins"
];
const rankTitles = ['E-Rank Hunter','D-Rank','C-Rank','B-Rank','A-Rank','S-Rank'];
const characterImages = [
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/male/45.png',
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/male/20.png',
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/female/68.png',
  'https://cdn.jsdelivr.net/gh/Ashwinvalento/cartoon-avatar@master/lib/images/female/21.png'
];
const workoutPlan = [
  {day: 1, title: "Shoulder & Posture", exercises: [
    "Curl Bar Overhead Press – 4 × 12",
    "Dumbbell Lateral Raise – 3 × 15",
    "Reverse Fly – 3 × 15",
    "Dumbbell Shrugs – 4 × 20",
    "Yoga: Bhujangasana – 2 × 30 sec"
  ]},
  {day: 2, title: "Arms (Biceps + Triceps)", exercises: [
    "Curl Bar Bicep Curl – 4 × 12–15",
    "Dumbbell Hammer Curl – 3 × 15",
    "Overhead Dumbbell Tricep Extension – 3 × 15",
    "Close-Grip Push-Ups – 3 × max",
    "Yoga: Tadasana – 1 min"
  ]},
  {day: 3, rest: true},
  {day: 4, title: "Full Shoulder + Arm Pump", exercises: [
    "Curl Bar Overhead Press – 3 × 12",
    "Curl Bar Bicep Curl – 3 × 12",
    "Dumbbell Lateral Raise + Shrugs (Superset) – 3 rounds",
    "Push-Ups – 3 × max",
    "Yoga: Anulom Vilom – 2 min"
  ]},
  {day: 5, title: "Yoga + Stability + Light Full Body", exercises: [
    "Surya Namaskar – 4 rounds",
    "Vrikshasana – 2 × 30 sec",
    "Bhujangasana + Shalabhasana – 3 × 30 sec each",
    "Kapalbhati Breathing – 1 min",
    "Tadasana with Deep Breathing – 1 min"
  ]},
  {day: 6, rest: true},
  {day: 7, title: "Core + Obliques", exercises: [
    "Dumbbell Side Bend – 4 × 20 each side",
    "Russian Twists (Dumbbell) – 3 × 30 sec",
    "Plank Hold – 3 × 40 sec",
    "Dumbbell Pullover – 4 × 12",
    "Yoga: Setu Bandhasana – 2 × 30 sec"
  ]}
];

function getXPForLevel(level){ return level*level*100; }
function getRank(level){
  if(level<5)return rankTitles[0];
  if(level<10)return rankTitles[1];
  if(level<15)return rankTitles[2];
  if(level<20)return rankTitles[3];
  if(level<25)return rankTitles[4];
  return rankTitles[5];
}

function App(){
  const [xp,setXP]=useState(parseInt(localStorage.getItem('xp'))||0);
  const [level,setLevel]=useState(parseInt(localStorage.getItem('level'))||1);
  const [tasks,setTasks]=useState(JSON.parse(localStorage.getItem('tasks'))||[]);
  const [habits,setHabits]=useState(JSON.parse(localStorage.getItem('habits'))||[]);
  const [punishments,setPunishments]=useState(JSON.parse(localStorage.getItem('punishments'))||[]);
  const [showAddModal,setShowAddModal]=useState(false);
  const [newTask,setNewTask]=useState({type:'daily',title:'',start:'',end:'',days:''});
  const [bossCountdown,setBossCountdown]=useState(parseInt(localStorage.getItem('bossCountdown'))||0);
  const [rivalXP,setRivalXP]=useState(parseInt(localStorage.getItem('rivalXP'))||0);
  const [rivalLevel,setRivalLevel]=useState(parseInt(localStorage.getItem('rivalLevel'))||1);
  const [lockdown,setLockdown]=useState(false);
  const [dailyQuest,setDailyQuest]=useState(JSON.parse(localStorage.getItem('dailyQuest'))||null);
  const [questDone,setQuestDone]=useState(localStorage.getItem('questDone')==='true');

  function startBossTimer(hours){
    const endTime=Date.now()+hours*60*60*1000;
    localStorage.setItem('bossEndTime',endTime);
  }
  function getRemainingBossTime(){
    const endTime=parseInt(localStorage.getItem('bossEndTime'))||0;
    return Math.max(0,endTime-Date.now());
  }
  function formatTime(ms){
    const totalSeconds=Math.floor(ms/1000);
    const hrs=Math.floor(totalSeconds/3600);
    const mins=Math.floor((totalSeconds%3600)/60);
    const secs=totalSeconds%60;
    return `${hrs}h ${mins}m ${secs}s`;
  }

  // Save state
  useEffect(()=>{
    localStorage.setItem('xp',xp);
    localStorage.setItem('level',level);
    localStorage.setItem('tasks',JSON.stringify(tasks));
    localStorage.setItem('habits',JSON.stringify(habits));
    localStorage.setItem('punishments',JSON.stringify(punishments));
    localStorage.setItem('dailyQuest',JSON.stringify(dailyQuest));
    localStorage.setItem('questDone',questDone);
  },[xp,level,tasks,habits,punishments,dailyQuest,questDone]);

  // Daily Quest Reset
  useEffect(()=>{
    const today=new Date();
    const lastQuestReset=localStorage.getItem('lastQuestReset');
    if(lastQuestReset!==today.toDateString()){
      const dayIndex=today.getDay();
      const workout=workoutPlan[dayIndex===0?6:dayIndex-1];
      if(!workout.rest){setDailyQuest(workout);setQuestDone(false);}
      else{setDailyQuest(null);setQuestDone(true);}
      localStorage.setItem('lastQuestReset',today.toDateString());
    }
  },[]);

  function completeQuest(){
    setQuestDone(true);
    setXP(xp+2);
    alert(`Daily Quest Completed! +2 XP`);
  }

  
  // === LEVEL UP ===
  useEffect(()=>{
    if(xp>=getXPForLevel(level)){
      setXP(xp-getXPForLevel(level));
      setLevel(level+1);
    }
  },[xp]);

  // Rival auto gain
  useEffect(()=>{
    const interval=setInterval(()=>{
      const gain=Math.floor(Math.random()*2);
      setRivalXP(prev=>{
        let newXP=prev+gain;
        if(newXP>=getXPForLevel(rivalLevel)){
          newXP=newXP-getXPForLevel(rivalLevel);
          setRivalLevel(rivalLevel+1);
        }
        return newXP;
      });
    },3600000);
    return()=>clearInterval(interval);
  },[rivalLevel]);

  // Punishment logic
  function addPunishment(p){
    if(p.type==='boss'){startBossTimer(3);}
    if(p.type==='weeklyBoss'){startBossTimer(10);}
    if(p.type==='dungeon'){startBossTimer(24);}
    setPunishments([...punishments,p]);
    setLockdown(true);
  }
  function completePunishment(){
    const[first,...rest]=punishments;
    let rewardXP=0;
    if(first.type==='boss'){rewardXP=4;}
    if(first.type==='weeklyBoss'){rewardXP=10;}
    if(first.type==='dungeon'){rewardXP=20;}
    setXP(xp+rewardXP);
    setPunishments(rest);
    if(rest.length===0)setLockdown(false);
    alert(`Completed! +${rewardXP} XP`);
  }
  function forgivePunishment(){
    setXP(Math.max(0,xp-15));
    completePunishment();
  }

  function completeTask(id){
    const task=tasks.find(t=>t.id===id);
    setTasks(tasks.filter(t=>t.id!==id));
    setXP(xp+2);
  }
  function completeHabit(id){
    setHabits(habits.map(h=>h.id===id?{...h,done:true}:h));
    setXP(xp+1);
  }
  function deleteHabit(id){
    setHabits(habits.filter(h=>h.id!==id));
  }

  // === UI RENDER ===
  return (
    <div className="p-4 max-w-3xl mx-auto bg-black bg-opacity-70 rounded-lg mt-6 shadow-lg">
      <header className="text-center mb-4">
        <h1 className="text-3xl font-bold">Solo Leveling Grind</h1>
        <p className="mt-2">Level {level} ({getRank(level)})</p>
        <div className="w-full bg-gray-700 rounded h-4 mt-2 overflow-hidden">
          <div className="bg-gradient-to-r from-blue-500 to-purple-600 h-4 rounded" style={{width:`${(xp/getXPForLevel(level))*100}%`}}></div>
        </div>
        <p className="text-sm mt-1">{xp}/{getXPForLevel(level)} XP</p>
        <img src={characterImages[Math.min(level-1,characterImages.length-1)]} className="mx-auto w-24 mt-4"/>
        <p>Rival: Lvl {rivalLevel} | XP: {rivalXP}</p>
      </header>

      {dailyQuest && !questDone && (
        <div className="bg-purple-700 p-4 rounded mb-4">
          <h2 className="text-xl font-bold">Daily Quest</h2>
          <p className="mt-1">{dailyQuest.title}</p>
          <ul className="mt-2 text-sm list-disc pl-5">
            {dailyQuest.exercises.map((ex,i)=><li key={i}>{ex}</li>)}
          </ul>
          <button onClick={completeQuest} className="mt-3 bg-green-500 px-3 py-1 rounded">Complete Quest (+2 XP)</button>
        </div>
      )}
      {questDone && <p className="text-green-400 mb-4">✅ Daily Quest Completed</p>}

      {punishments.length>0 && (
        <div className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center">
          <div className="bg-gray-800 p-6 rounded text-center max-w-md">
            <h2 className="text-2xl font-bold mb-4">Punishment</h2>
            <pre className="mb-4 whitespace-pre-wrap">{punishments[0].text}</pre>
            {['boss','weeklyBoss','dungeon'].includes(punishments[0].type) && (
              <p className="mt-2 text-red-400 text-lg font-bold">Time Left: {formatTime(getRemainingBossTime())}</p>
            )}
            <div className="flex justify-center gap-2 mt-4">
              <button onClick={completePunishment} className="bg-green-500 px-4 py-2 rounded">Complete</button>
              <button onClick={forgivePunishment} className="bg-yellow-500 px-4 py-2 rounded">Forgive (-15 XP)</button>
            </div>
          </div>
        </div>
      )}

      <div className="mt-6">
        <h2 className="text-xl mb-2 font-semibold">Tasks</h2>
        {!lockdown && (
          <button onClick={()=>setShowAddModal(true)} className="bg-blue-500 px-3 py-1 rounded mb-4">+ Add Task</button>
        )}
        {tasks.length===0?(
          <p>No tasks yet.</p>
        ):tasks.map(task=>(
          <div key={task.id} className="bg-gray-800 p-3 rounded mb-2 flex justify-between">
            <p>{task.title}</p>
            {!lockdown && <button onClick={()=>completeTask(task.id)} className="bg-green-500 px-3 py-1 rounded">Done</button>}
          </div>
        ))}
      </div>

      <div className="mt-6">
        <h2 className="text-xl mb-2 font-semibold">Habits</h2>
        {habits.map(h=>(
          <div key={h.id} className="bg-gray-800 p-3 rounded mb-2 flex justify-between">
            <p>{h.title}</p>
            <div>
              <button onClick={()=>completeHabit(h.id)} disabled={h.done||lockdown} className={`px-3 py-1 rounded ${h.done?'bg-gray-500':'bg-green-500'}`}>{h.done?'Done':'Mark Done'}</button>
              {!lockdown && <button onClick={()=>deleteHabit(h.id)} className="bg-red-500 px-3 py-1 ml-2 rounded">Delete</button>}
            </div>
          </div>
        ))}
      </div>

      {showAddModal && (
        <div className="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center">
          <div className="bg-gray-900 p-6 rounded max-w-md w-full">
            <h2 className="text-xl mb-4 font-semibold">Add Task</h2>
            <select value={newTask.type} onChange={e=>setNewTask({...newTask,type:e.target.value})} className="mb-4 w-full p-2 text-black rounded">
              <option value="daily">Daily Task</option>
              <option value="timed">Timed Task</option>
              <option value="habit">Habit</option>
            </select>
            <input type="text" placeholder="Task title" value={newTask.title} onChange={e=>setNewTask({...newTask,title:e.target.value})} className="w-full mb-4 p-2 text-black rounded"/>
            <div className="flex justify-end">
              <button onClick={()=>{
                const id=Date.now();
                const task={...newTask,id,done:false};
                if(newTask.type==='habit'){setHabits([...habits,task]);}
                else{setTasks([...tasks,task]);}
                setShowAddModal(false);
                setNewTask({type:'daily',title:''});
              }} className="bg-blue-600 px-4 py-2 rounded">Add</button>
              <button onClick={()=>setShowAddModal(false)} className="ml-2 bg-gray-600 px-4 py-2 rounded">Cancel</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
